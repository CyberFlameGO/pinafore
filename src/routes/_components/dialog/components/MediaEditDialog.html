<ModalDialog
  {id}
  {label}
  {title}
  background="var(--main-bg)"
  className="media-edit-dialog"
  on:show="measure()"
>
  <div class="media-edit-dialog-container">
    <div class="media-edit-header-and-item">
      <h2>Description</h2>
      <MediaAltEditor
        {realm}
        {index}
        {media}
        on:resize="measure()"
        ref:altEditor
      />
    </div>
    {#if type === 'image'}
      <div class="media-edit-header-and-item">
        <h2>Preview (focal point)</h2>
        <MediaFocalPointEditor
          {realm}
          {index}
          {media}
          ref:focalPointEditor
        />
      </div>
    {/if}
  </div>
</ModalDialog>
<style>
  :global(.media-edit-dialog) {
    max-width: calc(100%);
  }

  .media-edit-dialog-container {
    display: flex;
    flex-direction: row;
    max-height: calc(100% - 44px); /* 44px X button height */
    height: 100%;
    width: 100%;
  }

  .media-edit-header-and-item {
    padding: 10px;
  }

  .media-edit-header-and-item h2 {
    margin-bottom: 10px;
  }

  @media (max-width: 767px) {
    .media-edit-dialog-container {
      flex-direction: column;
      overflow: auto;
    }

    .media-edit-dialog-container {
      max-height: calc(100% - 25px); /* 25px X button height */
    }
  }

</style>
<script>
  import ModalDialog from './ModalDialog.html'
  import { show } from '../helpers/showDialog'
  import { close } from '../helpers/closeDialog'
  import { oncreate } from '../helpers/onCreateDialog'
  import MediaFocalPointEditor from '../components/MediaFocalPointEditor.html'
  import MediaAltEditor from '../components/MediaAltEditor.html'
  import { store } from '../../../_store/store'
  import { get } from '../../../_utils/lodash-lite'

  export default {
    oncreate,
    components: {
      ModalDialog,
      MediaFocalPointEditor,
      MediaAltEditor
    },
    methods: {
      show,
      close,
      measure () {
        this.refs.altEditor.measure()
        if (this.refs.focalPointEditor) {
          this.refs.focalPointEditor.measure()
        }
      }
    },
    store: () => store,
    computed: {
      media: ({ $currentInstance, $composeData, realm }) => (
        get($composeData, [$currentInstance, realm, 'media'])
      )
    }
  }
</script>
