{#if legacy}
  <!-- old browsers can't handle <use> very well -->
  <svg
    class={className}
    {style}
    aria-hidden={!ariaLabel}
    aria-label={ariaLabel}
    {viewBox}
    ref:svg>
    {@html html}
  </svg>
{:else}
  <svg
    class={className}
    {style}
    aria-hidden={!ariaLabel}
    aria-label={ariaLabel}
    ref:svg>
    <use xlink:href="{inline ? '' : '/icons.svg'}{href}" />
  </svg>
{/if}
<script>
  import { animate } from '../_utils/animate'
  import { store } from '../_store/store'

  export default {
    data: () => ({
      className: '',
      style: '',
      ariaLabel: '',
      legacy: process.env.LEGACY
    }),
    store: () => store,
    computed: {
      inline: ({ href }) => !process.env.LEGACY && process.env.INLINE_SVGS.includes(href),
      svgData: ({ href })=> process.env.LEGACY && process.env.ALL_SVGS[href],
      html: ({ svgData }) => svgData && svgData.html,
      viewBox: ({ svgData }) => svgData && svgData.viewBox,
    },
    methods: {
      animate (animation) {
        const { reduceMotion } = this.store.get()
        if (!animation || reduceMotion) {
          return
        }
        const svg = this.refs.svg
        animate(svg, animation)
      }
    }
  }
</script>
